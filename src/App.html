<template>
<div class="drawer ">
  <input id="main-drawer" type="checkbox" class="drawer-toggle" />
  
  <div class="drawer-content flex flex-col items-center justify-center">
    <!-- Page content here -->
    <nav class="w-full navbar bg-base-300">
      <div class="flex-none">
        <label for="main-drawer" aria-label="open sidebar" class="btn btn-square btn-ghost">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </label>
      </div>

      <h1 class="flex-1 px-2 mx-2 text-2xl font-bold">{{ $route.name }}</h1>

      <div>{{currentUserEmail.innerText}}でログイン中</div>
    </nav>

    <RouterView v-slot="{ Component }">
      <template v-if="Component">
        <Suspense>
          <main class="px-3 text-sm h-full w-full">
            <component :is="Component"></component>
          </main>

          <template #fallback>
              <div class="w-screen h-screen flex flex-col justify-center items-center">
                <span class="loading loading-spinner loading-lg"></span>
              </div>
          </template> 
        </Suspense>
      </template>
    </RouterView>
  
  </div>

  <div class="drawer-side">
    <label for="main-drawer" aria-label="close sidebar" class="drawer-overlay"></label> 
    <ul class="menu p-4 w-54 min-h-full bg-base-200 text-base-content">
      <!-- Sidebar content here -->
      <li v-for="r of routes">
        <a @click="$router.push(`${r.path}`)">{{r.name}}</a>
      </li>
    </ul>
  
  </div>
</div>

</template>

<script>

const App = defineComponent({
  setup(){
    const router = useRouter()
    const routes = router.getRoutes()

    return {currentUserEmail, routes}
  },
  template:'#app'
})

</script>