<template>

  <div class=" pt-4 flex" >
      <!-- <div class="overflow-hidden">
        <div id="example"></div>
      </div>

      <div class="bg-orange-100 h-full w-96 flex-none p-3">
        <div v-if="!原資材item">資材を選んでください</div>

        <div v-if="原資材item">
            <div class="flex justify-between items-base">
              <label class=" text-lg font-bold ">構成</label>

              <button v-if="原資材item['構成コード']" class="btn btn-primary" @click="原資材item['構成コード']=''">再編集</button>
              <a v-if="!原資材item['構成コード']" class="link link-primary" onclick="my_modal_1.showModal()">登録済コンポーネントから選ぶ</a>
              <button v-if="!原資材item['構成コード']" class="btn btn-ghost" @click="原資材item = null">キャンセル</button>
              <button v-if="!原資材item['構成コード']" class="btn btn-primary" @click="save">保存</button>
            </div>

            <dialog id="my_modal_1" class="modal">
              <div class="modal-box">
                <h3 class="font-bold text-lg">構成選択</h3>

                <label>
                  構成名検索
                  <input class="input input-sm input-bordered" v-model="構成名検索word">
                </label>

                <table class="table table-sm">
                  <tbody>
                    <tr v-for="構成item of 構成候補items">
                      <td>{{構成item['構成名']}}</td>
                      <td>
                        <button @click="原資材item['構成コード']=構成item['構成コード'];my_modal_1.close()"
                        class="btn btn-primary btn-xs">選択</button>
                      </td>
                    </tr>
                  </tbody>
                </table>

                <div class="modal-action">
                  <form method="dialog">
                    <button class="btn">閉じる</button>
                  </form>
                </div>
              </div>
            </dialog>

            <Detail :key="原資材item['品目コード']" v-model="原資材item"></Detail>
        </div>

      </div> -->
      <div id="example"></div>

      <input @input="setDoc($event.target.value)">

      <button @click="setDoc('ccc')">更新</button>

      <div>{{sample}}</div>
  </div>
  
</template>

<script>
const Index = defineComponent({
  components:{},
  async setup(){

    var grid;

    onMounted(()=>{
        console.log(Object.values(自所属原資材docs))

        grid = new Grid({
            columns:['品目コード','品名','取引先名','担当者名',
              // {id:'構成コード',label:'',formatter: (cell, row) => cell? html(`<div">済</div>`):html(`<div"></div>`)}
            ],
            data:Object.values(自所属原資材docs),
        })
        
        grid.on('rowClick', (...args) => {
          const {cells} = args[1]
          const {data:品目コード} = cells[0]
          原資材item.value = 自所属原資材docs[品目コード]
        });

        grid.render(document.getElementById('example'))
    })

    const {自所属users} = await useUsers()
    const {自所属原資材docs,使いまわし情報docs,setDoc} = await useTables()

    const 原資材item = ref()

    function save(){
      console.log(原資材item)
    }

    return {currentUserEmail,原資材item, save, setDoc}
  },
  template:'#index'
})
</script>
