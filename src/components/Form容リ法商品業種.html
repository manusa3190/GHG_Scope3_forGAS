<script lang="ts">
import { defineComponent, onMounted } from 'vue'
import { useField } from 'vee-validate'
import useMasters from '@/stores/useMasters'

export default defineComponent({
  setup(){
    const { handleChange, value, handleBlur, errorMessage, meta, setValue } = useField(() => '容リ法商品業種',undefined);

    const {容リ法商品業種items} = useMasters()

    return {容リ法商品業種items, handleChange, setValue, value,errorMessage,}
  }
})

</script>

<template>
    <dl class="flex justify-between items-end max-w-60 h-8">
      <dt class="">容リ法商品業種</dt>
      <dd class="link" onclick="容リ法商品業種modal.showModal()">{{ value || '未選択' }}</dd>
    </dl>
    <div class="text-red-500 text-xs">{{errorMessage}}</div>

    <dialog id="容リ法商品業種modal" class="modal ">
      <div class="modal-box max-w-none w-[800px]">

        <p class="py-4">資材の商品業種を選択してください</p>

        <table class="table table-sm">
          <thead>
            <tr>
              <td width="100px">分類</td><td>内容</td>
            </tr>
          </thead>

          <tbody>
            <tr v-for="item of 容リ法商品業種items" :key="item['分類']"
             class=" hover:bg-base-200 active:bg-base-100 cursor-pointer" 
             :class="{'bg-orange-100':item['分類']===value}" @click="setValue(item['分類'])"
            >
              <td>{{item['分類']}}</td><td>{{item['内容']}}</td>
            </tr>
          </tbody>
        </table>

        <div class="modal-action">
          <form method="dialog">
            <button class="btn">閉じる</button>
          </form>
        </div>
      </div>
    </dialog>
</template>